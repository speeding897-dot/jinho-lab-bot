name: Jinho Lab Daily Job

on:
  schedule:
    - cron: '0 22 * * *'  # ë§¤ì¼ í•œêµ­ì‹œê°„ ì˜¤ì „ 7ì‹œ
  workflow_dispatch:      # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

# [í•„ìˆ˜] ê¹ƒí—ˆë¸Œ ë¡œë´‡ì—ê²Œ íŒŒì¼ ì“°ê¸° ê¶Œí•œ ë¶€ì—¬
permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v3

      - name: íŒŒì´ì¬ ì„¤ì •
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
        run: |
          pip install requests beautifulsoup4

      - name: 1. ì¸í¬ë£¨íŠ¸ ì‚¬ê¸°ì—… ë°ì´í„° ìˆ˜ì§‘ (collector.py)
        run: python collector.py

      - name: 2. ê³µê¸°ì—… ì±„ìš©ê³µê³  ê°±ì‹  (main.py)
        run: python main.py

      - name: 3. ì‚¬ê¸°ì—… ì±„ìš©ê³µê³  ê°±ì‹  (main_private.py)
        run: python main_private.py

      - name: ê²°ê³¼ ê¹ƒí—ˆë¸Œì— ë°˜ì˜ (ê°•ì œ ì—…ë¡œë“œ)
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          
          # [í•µì‹¬ ìˆ˜ì •] ì‚­ì œí›„ ì¬ìƒì„±ëœ íŒŒì¼ê¹Œì§€ ëª¨ì¡°ë¦¬ ì¡ì•„ì„œ ì˜¬ë¦½ë‹ˆë‹¤.
          git add --all
          
          # ë³€ê²½ì‚¬í•­ì´ ìˆìœ¼ë©´ ì»¤ë°‹í•˜ê³ , ì—†ìœ¼ë©´ ë„˜ì–´ê°‘ë‹ˆë‹¤ (ì—ëŸ¬ ë°©ì§€)
          git commit -m "ğŸš€ ì±„ìš©ê³µê³  ì „ì²´ ì¬ìƒì„± ë° ë³µêµ¬ ì™„ë£Œ [$(date)]" || echo "ë³€ê²½ì‚¬í•­ ì—†ìŒ"
          
          # ë©”ì¸ ë¸Œëœì¹˜ë¡œ ê°•ì œ ì „ì†¡
          git push
