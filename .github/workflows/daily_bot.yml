name: Jinho Lab Daily Job

on:
  schedule:
    - cron: '0 22 * * *'  # ë§¤ì¼ í•œêµ­ì‹œê°„ ì˜¤ì „ 7ì‹œ
  workflow_dispatch:      # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

# [ì¶”ê°€] ê¹ƒí—ˆë¸Œ ë¡œë´‡ì—ê²Œ íŒŒì¼ ì“°ê¸° ê¶Œí•œ ë¶€ì—¬
permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v3

      - name: íŒŒì´ì¬ ì„¤ì •
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
        run: |
          pip install requests beautifulsoup4

      - name: 1. ì¸í¬ë£¨íŠ¸ ì‚¬ê¸°ì—… ë°ì´í„° ìˆ˜ì§‘ (collector.py)
        run: python collector.py

      - name: 2. ê³µê¸°ì—… ì±„ìš©ê³µê³  ê°±ì‹  (main.py)
        run: python main.py

      - name: 3. ì‚¬ê¸°ì—… ì±„ìš©ê³µê³  ê°±ì‹  (main_private.py)
        run: python main_private.py

      # â˜…â˜…â˜… [í•µì‹¬] ì´ ë‹¨ê³„ê°€ ëª¨ë“  ë³´ì•ˆ êµ¬ë©ì„ ë§‰ì•„ì¤ë‹ˆë‹¤ â˜…â˜…â˜…
      - name: 4. ê¸°ì¡´ íŒŒì¼ ë³´ì•ˆ íŒ¨ì¹˜ ê°•ì œ ì‹¤í–‰ (patch_fix.py)
        run: python patch_fix.py

      - name: ê²°ê³¼ ê¹ƒí—ˆë¸Œì— ë°˜ì˜ (Commit & Push)
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          git add .
          # ë³€ê²½ëœ ëª¨ë“  íŒŒì¼(html, json, txt)ì„ ê°•ì œë¡œ í¬í•¨ì‹œí‚µë‹ˆë‹¤.
          git commit -m "ğŸš€ ê³µê¸°ì—…/ì‚¬ê¸°ì—… ì±„ìš©ê³µê³  ë° ë³´ì•ˆ íŒ¨ì¹˜ ì™„ë£Œ [$(date)]" || echo "ë³€ê²½ì‚¬í•­ ì—†ìŒ"
          git push
